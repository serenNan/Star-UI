<!-- ================================
     Banner åŒºåŸŸ - å®‡èˆªå‘˜å…¨å±èƒŒæ™¯è®¾è®¡
     ================================ -->

<style>
/* ================================
   Banner ä¸“å±æ ·å¼
   ================================ */

/* 1. åŸºç¡€å¸ƒå±€ - å®‡èˆªå‘˜å…¨å±èƒŒæ™¯ï¼ˆå»¶ä¼¸åˆ°å¯¼èˆªæ ä¸Šæ–¹ï¼‰*/
.banner {
  position: relative;
  min-height: 100vh;
  background-image: url('sections/banner/1.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  padding-top: calc(var(--nav-height) + var(--spacing-lg)); /* å‡å°é¡¶éƒ¨å†…è¾¹è· */
  padding-bottom: calc(22rem + var(--spacing-2xl)); /* å¢åŠ åº•éƒ¨å†…è¾¹è·ï¼Œä¸ºå¡ç‰‡ç•™å‡ºç©ºé—´ */
  overflow: visible; /* å…è®¸å†…å®¹æº¢å‡ºï¼Œç¡®ä¿å¡ç‰‡å¯è§ */
}

/* æ·±è‰²æ¸å˜é®ç½©å±‚ - å·²ç§»é™¤ */
/* .banner::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to right,
    rgba(0, 0, 0, 0.2) 0%,
    rgba(0, 0, 0, 0.1) 50%,
    rgba(0, 0, 0, 0.15) 100%
  );
  z-index: 0;
} */

/* æ˜Ÿç©ºèƒŒæ™¯æ•ˆæœ */
.banner::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image:
    radial-gradient(2px 2px at 20% 30%, white, transparent),
    radial-gradient(2px 2px at 60% 70%, white, transparent),
    radial-gradient(1px 1px at 50% 50%, white, transparent),
    radial-gradient(2px 2px at 80% 10%, white, transparent),
    radial-gradient(1px 1px at 30% 80%, white, transparent);
  background-size: 200px 200px;
  opacity: 0.2;
  pointer-events: none;
  z-index: 1;
}

.banner-container {
  position: relative;
  max-width: 100%; /* ä½¿ç”¨å…¨å®½ï¼Œä¸é™åˆ¶å®¹å™¨å®½åº¦ */
  margin: 0 auto;
  padding: 0 3rem; /* å‡å°å·¦å³å†…è¾¹è· */
  height: 100%;
  z-index: 2;
}

/* 2. å·¦ä¾§å†…å®¹åŒº */
.banner-left {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-md); /* å‡å°å†…éƒ¨é—´è· */
  max-width: 800px; /* è°ƒæ•´æœ€å¤§å®½åº¦ */
  margin: 0 auto; /* æ”¹ä¸ºå±…ä¸­ */
  margin-top: clamp(2.5rem, 5vw, 4.5rem); /* ä¸­ç­‰å¹…åº¦ä¸‹ç§» */
  text-align: center; /* å­å…ƒç´ æ–‡å­—å±…ä¸­ */
  z-index: 3;
}

.banner-title {
  font-size: clamp(1.5rem, 3vw, 2.5rem); /* å‡å°å­—ä½“ï¼šä» 1.75-3rem æ”¹ä¸º 1.5-2.5rem */
  font-weight: 700;
  font-style: italic; /* è®¾ç½®ä¸ºæ–œä½“ */
  line-height: 1.2; /* è®¾ç½®è¡Œé«˜ */
  color: var(--color-text);
  margin: 0;
  margin-bottom: -0.5rem; /* è´Ÿé—´è·,è®©å‰¯æ ‡é¢˜å‘ä¸Šç§»åŠ¨ */
  letter-spacing: -0.02em;
  max-width: 900px; /* å¢å¤§æœ€å¤§å®½åº¦ï¼šä» 700px æ”¹ä¸º 900pxï¼Œå‡å°‘æ¢è¡Œ */
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}

.banner-subtitle {
  font-size: clamp(0.875rem, 1.5vw, 1rem);
  line-height: 1.6;
  color: #FFFFFF; /* æ”¹ä¸ºç™½è‰²ï¼šä» var(--color-text-secondary) æ”¹ä¸ºçº¯ç™½ */
  margin: 0;
  margin-bottom: var(--spacing-xs);
  max-width: 500px;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}

/* æœç´¢æ¡†åŒºåŸŸ */
.search-box-container {
  position: relative;
  width: 100%;
  max-width: 550px; /* å‡å°å®½åº¦ï¼šä» 700px æ”¹ä¸º 550px */
  margin: 0 auto;
}

.search-input {
  width: 100%;
  padding: 10px 140px 10px 20px; /* ä¸Šä¸‹è¾¹è·ç›¸ç­‰ï¼šéƒ½è®¾ä¸º 10pxï¼Œä½¿æ–‡å­—å‚ç›´å±…ä¸­ */
  background: rgba(0, 0, 0, 0.5); /* æ”¹ä¸ºé»‘è‰²èƒŒæ™¯ï¼Œé€æ˜åº¦0.5 */
  border: none !important; /* å¼ºåˆ¶å»é™¤è¾¹æ¡† */
  outline: none !important; /* å¼ºåˆ¶å»é™¤è½®å»“çº¿ */
  box-shadow: none !important; /* å¼ºåˆ¶å»é™¤é˜´å½± */
  border-radius: 25px; /* å¢å¤§åœ†è§’ï¼šä» 10px æ”¹ä¸º 25px */
  color: var(--color-text);
  font-size: 0.7rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ï¼šä» 0.75rem æ”¹ä¸º 0.7rem */
  font-family: inherit;
  line-height: 1.4; /* è®¾ç½®è¡Œé«˜ï¼Œä¾¿äºå¤šè¡Œæ˜¾ç¤º */
  transition: all var(--transition);
  backdrop-filter: blur(10px);
  white-space: pre-wrap; /* ä¿ç•™ç©ºæ ¼å¹¶å…è®¸æ¢è¡Œ */
  word-wrap: break-word; /* å¼ºåˆ¶é•¿å•è¯æ¢è¡Œ */
  overflow-wrap: break-word; /* ç¡®ä¿å†…å®¹ä¸æº¢å‡º */
  min-height: 48px; /* ä¿æŒæœ€å°é«˜åº¦ 48px */
  resize: none; /* å¦‚æœæ˜¯ textareaï¼Œç¦æ­¢è°ƒæ•´å¤§å° */
  vertical-align: middle; /* å‚ç›´å¯¹é½ */
}

.search-input::placeholder {
  color: rgba(255, 255, 255, 0.5);
}

.search-input:focus {
  outline: none !important; /* å¼ºåˆ¶å»é™¤é»˜è®¤å¤–è¾¹æ¡† */
  background: rgba(0, 0, 0, 0.6); /* ç„¦ç‚¹æ—¶èƒŒæ™¯æ›´æ·± */
  box-shadow: none !important; /* å¼ºåˆ¶å»é™¤ç„¦ç‚¹æ—¶çš„é˜´å½± */
  border: none !important; /* å¼ºåˆ¶å»é™¤è¾¹æ¡† */
}

.btn-run-engine {
  position: absolute;
  right: 6px;
  top: 50%;
  transform: translateY(-50%);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 16px; /* å‡å°å†…è¾¹è·ï¼šä» 12px 24px æ”¹ä¸º 8px 16px */
  background: white;
  color: black;
  font-size: 1rem; /* å­—ä½“ä¿æŒä¸å˜ */
  font-weight: 600;
  border: none;
  border-radius: 20px; /* å¢å¤§åœ†è§’ï¼šä» 10px æ”¹ä¸º 20pxï¼Œä¸æœç´¢æ¡†åŒ¹é… */
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition);
  white-space: nowrap;
}

.btn-run-engine:hover {
  transform: translateY(calc(-50% - 2px));
  box-shadow: 0 8px 24px rgba(255, 255, 255, 0.3);
  background: rgba(255, 255, 255, 0.95);
}

/* 3. å³ä¸‹è§’èƒŒæ™¯åˆ‡æ¢å¡ç‰‡åŒº - æ°´å¹³æ’åˆ—ä¸æ¢è¡Œ */
.video-cards-container {
  position: absolute; /* ç›¸å¯¹äº banner-container å®šä½ */
  left: 50%; /* å±…ä¸­å®šä½ */
  transform: translateX(-50%);
  bottom: -29rem; /* é€‚åº¦ä¸Šç§»ï¼Œé¿å…é®æŒ¡ */
  z-index: 100; /* æé«˜å±‚çº§,ç¡®ä¿åœ¨æ‰€æœ‰å†…å®¹ä¹‹ä¸Š */
  overflow: hidden; /* éšè—æº¢å‡ºéƒ¨åˆ† */
  width: calc(5 * 81px + 4 * 1rem); /* æ˜¾ç¤º5å¼ å¡ç‰‡åŠé—´è· */
  padding: 1.25rem 0; /* ä¸ºæ”¾å¤§å¡ç‰‡é¢„ç•™å‚ç›´ç©ºé—´ */
}

.video-cards-grid {
  display: flex;
  gap: 1rem; /* é—´è· 16px */
  flex-wrap: nowrap; /* ç¦æ­¢æ¢è¡Œ */
  align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½ */
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); /* æ»‘åŠ¨åŠ¨ç”» */
  will-change: transform; /* æ€§èƒ½ä¼˜åŒ– */
}

/* å•ä¸ªå¡ç‰‡åŒ…è£…å™¨ï¼ˆåŒ…å«æ ‡é¢˜ï¼‰*/
.video-card-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start; /* ä»é¡¶éƒ¨å¼€å§‹å¸ƒå±€ */
  flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
  position: relative; /* ä¸º z-index ç”Ÿæ•ˆåˆ›å»ºå®šä½ä¸Šä¸‹æ–‡ */
  z-index: 10; /* ç¡®ä¿åŒ…è£…å™¨ä¹Ÿåœ¨é«˜å±‚çº§ */
  min-height: 150px; /* è®¾ç½®æœ€å°é«˜åº¦,ç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´ */
  padding-top: 21px; /* é¡¶éƒ¨padding = (150px - 108px) / 2,è®©å¡ç‰‡åœ¨åŒ…è£…å™¨ä¸­å‚ç›´å±…ä¸­ */
  --title-spacing: 0.5rem;
  --title-opacity: 0.85;
}

/* å¡ç‰‡æ ‡é¢˜ï¼ˆæ˜¾ç¤ºåœ¨å¡ç‰‡ä¸‹æ–¹ï¼‰*/
.card-title {
  font-size: 0.7rem; /* å­—ä½“æ”¾å¤§ï¼šä» 0.6rem æ”¹ä¸º 0.7rem */
  font-weight: 600;
  color: var(--color-text);
  text-align: center; /* å±…ä¸­å¯¹é½ */
  letter-spacing: 0.05em;
  white-space: nowrap;
  display: block;
  width: 100%;
  margin: 0;
  margin-top: var(--title-spacing); /* ä¿ç•™åŠ¨æ€é—´è·æ•ˆæœ */
  opacity: var(--title-opacity);
  transition: margin-top 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: margin-top, opacity;
}

.video-card-wrapper.gap-small {
  --title-spacing: 0.05rem; /* æœ€å¤–ä¾§ï¼šè·ç¦»æœ€è¿‘ */
  --title-opacity: 0.55;
}

.video-card-wrapper.gap-medium {
  --title-spacing: 0.95rem; /* å·¦å³ä¸¤ä¾§ï¼šé€‚ä¸­è·ç¦» */
  --title-opacity: 0.85;
}

.video-card-wrapper.gap-large {
  --title-spacing: 1.75rem; /* ä¸­å¿ƒå¡ç‰‡ï¼šè·ç¦»æœ€å¤§ */
  --title-opacity: 1;
}

/* å¡ç‰‡ä¸»ä½“ - orderå±æ€§å·²ç§»é™¤,å› æ ‡é¢˜æ”¹ä¸ºç»å¯¹å®šä½ */

/* èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ - æ›´é•¿çš„é«˜åº¦ */
.video-card {
  position: relative;
  width: 81px; /* å‡å°å®½åº¦ï¼šä» 90px æ”¹ä¸º 70px */
  height: 108px; /* å‡å°é«˜åº¦ï¼šä» 120px æ”¹ä¸º 100px */
  border-radius: 4px; /* å‡å°åœ†è§’ï¼šä» 6px æ”¹ä¸º 3px */
  overflow: hidden;
  cursor: pointer;
  background: var(--color-bg-secondary);
  border: 1px solid transparent; /* é»˜è®¤é€æ˜è¾¹æ¡† */
  transform: scale(0.7);
  opacity: 0.6;
  z-index: 1;
  transform-style: preserve-3d; /* å¯ç”¨3Då˜æ¢ */
  perspective: 1000px; /* 3Dé€è§†è·ç¦» */
  transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1),
              opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1),
              box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: transform; /* æ€§èƒ½ä¼˜åŒ– */
}

/* é€‰ä¸­çŠ¶æ€ - å¤–å›´ç™½è‰²è¾¹æ¡† */
.video-card.active {
  transform: scale(1);
  opacity: 1;
  z-index: 3;
  outline: 1px solid white;
  outline-offset: 1.5px;
  box-shadow: 0 8px 24px rgba(255, 255, 255, 0.25);
}

/* ç›¸é‚»å¡ç‰‡ - ç¬¬äºŒå±‚ */
.video-card.adjacent {
  transform: scale(0.85);
  opacity: 0.8;
  z-index: 2;
}

/* å¡ç‰‡å›¾ç‰‡ */
.video-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* âœ¨ äº”ä¸ªä½ç½®çš„å€¾æ–œæ ·å¼(åŠ å…¥ translateY è®©å¯è§ä¸­å¿ƒå¯¹é½) */
/* ä½ç½®0 - æœ€å·¦ä¾§å¡ç‰‡,å‘å·¦å€¾æ–œ12åº¦ */
.video-card.position-0 {
  transform: translateY(-16px) scale(0.7) rotateY(-12deg);
  opacity: 0.5;
  box-shadow: -5px 10px 25px rgba(0, 0, 0, 0.4);
}

/* ä½ç½®1 - å·¦ä¾§å¡ç‰‡,å‘å·¦å€¾æ–œ6åº¦ */
.video-card.position-1 {
  transform: translateY(-8px) scale(0.85) rotateY(-6deg);
  opacity: 0.7;
  box-shadow: -3px 8px 20px rgba(0, 0, 0, 0.35);
}

/* ä½ç½®2 - ä¸­é—´å¡ç‰‡,ä¸å€¾æ–œ(æ¿€æ´»çŠ¶æ€) */
.video-card.position-2 {
  transform: translateY(0px) scale(1) rotateY(0deg);
  opacity: 1;
  box-shadow: 0 15px 40px rgba(255, 255, 255, 0.2);
}

/* ä½ç½®3 - å³ä¾§å¡ç‰‡,å‘å³å€¾æ–œ6åº¦ */
.video-card.position-3 {
  transform: translateY(-8px) scale(0.85) rotateY(6deg);
  opacity: 0.7;
  box-shadow: 3px 8px 20px rgba(0, 0, 0, 0.35);
}

/* ä½ç½®4 - æœ€å³ä¾§å¡ç‰‡,å‘å³å€¾æ–œ12åº¦ */
.video-card.position-4 {
  transform: translateY(-16px) scale(0.7) rotateY(12deg);
  opacity: 0.5;
  box-shadow: 5px 10px 25px rgba(0, 0, 0, 0.4);
}

/* 5. å“åº”å¼æ ·å¼ */

/* å¹³æ¿ç«¯ (768px - 991px) */
@media (max-width: 991px) {
  /* Banner ä¸»å®¹å™¨ - æ”¹ä¸ºè‡ªåŠ¨é«˜åº¦,å…è®¸å¡ç‰‡æº¢å‡º */
  .banner {
    min-height: auto;
    padding-top: calc(var(--nav-height) + var(--spacing-2xl));
    padding-bottom: var(--spacing-3xl);
    background-position: center center;
    overflow-x: hidden; /* åªéšè—æ¨ªå‘æº¢å‡º */
    overflow-y: visible; /* å…è®¸çºµå‘æº¢å‡º,å¡ç‰‡å‘ä¸Šæµ®åŠ¨ä¸è¢«è£å‰ª */
  }

  /* å†…å®¹å®¹å™¨ - æ”¹ä¸ºå‚ç›´æµå¼å¸ƒå±€,å±…ä¸­å¯¹é½ */
  .banner-container {
    display: flex;
    flex-direction: column;
    align-items: center;  /* æ‰€æœ‰å­å…ƒç´ æ°´å¹³å±…ä¸­ */
    gap: var(--spacing-xl);
    padding: 0 2rem;
  }

  /* å·¦ä¾§å†…å®¹åŒº - å æ»¡å®½åº¦,å±…ä¸­å¯¹é½ */
  .banner-left {
    max-width: 100%;
    margin-left: 0;
    margin-top: var(--spacing-xl);
    text-align: center;  /* æ–‡å­—å±…ä¸­ */
    display: flex;
    flex-direction: column;
    align-items: center;  /* å­å…ƒç´ å±…ä¸­ */
  }

  /* æ ‡é¢˜å’Œå‰¯æ ‡é¢˜å±…ä¸­ */
  .banner-title,
  .banner-subtitle {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
  }

  /* å¡ç‰‡å®¹å™¨ - æ”¹ä¸ºé™æ€å®šä½ + æ°´å¹³æ»šåŠ¨,å±…ä¸­å¯¹é½ */
  .video-cards-container {
    position: static;
    right: auto;
    left: auto;
    transform: none;
    bottom: auto;
    max-width: 100%;
    width: 100%;
    margin: 0 auto;
    overflow-x: auto;
    overflow-y: visible; /* æ”¹ä¸º visible,å…è®¸å¡ç‰‡å‘ä¸Šæµ®åŠ¨ */
    padding: 1rem; /* å¢åŠ ä¸Šä¸‹ padding,ä¸ºæ‚¬æµ®æ•ˆæœç•™ç©ºé—´ */
    display: flex;
    justify-content: center;  /* å¡ç‰‡ç½‘æ ¼å±…ä¸­ */
  }

  /* å¡ç‰‡ç½‘æ ¼ - æ”¯æŒæ»šåŠ¨ */
  .video-cards-grid {
    gap: 0.75rem;
    padding: var(--spacing-sm) 0; /* ä¸Šä¸‹ç•™å‡ºç©ºé—´ */
    justify-content: center;  /* å¡ç‰‡å±…ä¸­ */
  }

  .video-card-wrapper {
    flex-shrink: 0;
  }

  /* æ»šåŠ¨æ¡ç¾åŒ– */
  .video-cards-container::-webkit-scrollbar {
    height: 6px;
  }

  .video-cards-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
  }

  .video-cards-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
  }

  .video-cards-container::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  /* æ»šåŠ¨æç¤ºæ¸å˜é®ç½© */
  .video-cards-container::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    bottom: 6px;
    width: 40px;
    background: linear-gradient(to left, var(--color-bg), transparent);
    pointer-events: none;
  }
}

/* ç§»åŠ¨ç«¯ (< 768px) */
@media (max-width: 767px) {
  /* Banner å®¹å™¨ */
  .banner {
    padding-top: calc(var(--nav-height) + var(--spacing-xl));
    padding-bottom: var(--spacing-2xl);
    min-height: auto;
  }

  /* å†…å®¹å®¹å™¨ - å‡å°å·¦å³è¾¹è·,ç¡®ä¿å±…ä¸­ */
  .banner-container {
    padding: 0 1.5rem;
    gap: var(--spacing-lg);
    align-items: center;  /* å¼ºåˆ¶æ‰€æœ‰å­å…ƒç´ å±…ä¸­ */
  }

  /* å·¦ä¾§å†…å®¹ - å±…ä¸­å¯¹é½ */
  .banner-left {
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    margin-top: var(--spacing-lg);
  }

  .banner-title {
    font-size: 2rem;
    max-width: 100%;
    text-align: center;
  }

  .banner-subtitle {
    font-size: 0.875rem;
    max-width: 100%;
    text-align: center;
  }

  /* æœç´¢æ¡† - å±…ä¸­æ˜¾ç¤º */
  .search-box-container {
    max-width: 100%;
  }

  .search-input {
    padding: 12px 120px 12px 16px;
    font-size: 0.9rem;
  }

  .btn-run-engine {
    padding: 10px 20px;
    font-size: 0.9rem;
    right: 4px;
  }

  /* å¡ç‰‡ */
  .video-card {
    width: 100px;
    height: 133px; /* ä¿æŒæ¯”ä¾‹: 100/81 * 108 â‰ˆ 133 */
  }

  .card-title {
    font-size: 0.75rem;
  }
}

/* å°å±æ‰‹æœº (< 480px) */
@media (max-width: 479px) {
  .banner-container {
    padding: 0 var(--spacing-md);
    align-items: center;  /* ç¡®ä¿å±…ä¸­ */
  }

  .banner-title {
    font-size: clamp(1.5rem, 8vw, 1.75rem);
    text-align: center;
  }

  .banner-subtitle {
    text-align: center;
  }

  .search-input {
    padding: 12px 110px 12px 14px;
  }

  .btn-run-engine {
    padding: 10px 16px;
    font-size: 0.85rem;
    right: 3px;
  }

  .video-card {
    width: 85px;
    height: 113px; /* ä¿æŒæ¯”ä¾‹: 85/81 * 108 â‰ˆ 113 */
  }

  .card-title {
    font-size: 0.7rem;
  }
}

/* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
@media (max-width: 991px) {
  /* è§¦æ‘¸åé¦ˆ */
  .video-card:active {
    transform: scale(0.95);
    transition: transform 0.1s ease;
  }

  .btn-run-engine:active {
    transform: translateY(-50%) scale(0.98);
  }
}

/* ç§»åŠ¨ç«¯ç¦ç”¨å€¾æ–œæ•ˆæœ - ä¿æŒç®€æ´ */
@media (max-width: 991px) {
  /* é‡ç½®æ‰€æœ‰å€¾æ–œä½ç½®ç±»,ç§»é™¤ rotateY å¹¶ä¿æŒè§†è§‰ä¸­å¿ƒå¯¹é½ */
  .video-card.position-0,
  .video-card.position-4 {
    transform: translateY(-16px) scale(0.7) rotateY(0deg) !important;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3) !important;
  }

  .video-card.position-1,
  .video-card.position-3 {
    transform: translateY(-8px) scale(0.85) rotateY(0deg) !important;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3) !important;
  }

  .video-card.position-2 {
    transform: translateY(0px) scale(1) rotateY(0deg) !important;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3) !important;
  }

/* æ€§èƒ½ä¼˜åŒ– - ç¦ç”¨åŠ¨ç”»åå¥½ */
@media (prefers-reduced-motion: reduce) {
  .video-card,
  .btn-run-engine {
    transition: none !important;
  }

  .banner::before {
    animation: none !important;
  }
}
</style>

<!-- HTML ç»“æ„ -->
<section class="banner">
  <div class="banner-container">
    <!-- å·¦ä¾§å†…å®¹åŒº -->
    <div class="banner-left">
      <h1 class="banner-title">
        WHERE IMAGINATION ECLIPSES REALITY
      </h1>

      <p class="banner-subtitle">
        Built For Brands, Artists, And Creators.
      </p>

      <div class="search-box-container">
        <textarea
          class="search-input"
          rows="2"
          placeholder="ultra-realistic close-up of an astronaut in a detailed white space suit, standing in the darkness of outer space..."
        ></textarea>
        <button class="btn-run-engine" type="button">Run Engine</button>
      </div>
    </div>

    <!-- å³ä¸‹è§’èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ - æ°´å¹³æ’åˆ—ä¸æ¢è¡Œ -->
    <div class="video-cards-container">
      <div class="video-cards-grid">
        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 1 -->
        <div class="video-card-wrapper">
          <div class="video-card active" data-bg-index="0">
            <img src="sections/banner/1.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 2 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="1">
            <img src="sections/banner/2.jpg" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 3 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="2">
            <img src="sections/banner/3.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 4 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="3">
            <img src="sections/banner/4.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 5 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="4">
            <img src="sections/banner/5.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 6 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="5">
            <img src="sections/banner/6.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 7 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="6">
            <img src="sections/banner/7.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 8 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="7">
            <img src="sections/banner/8.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 9 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="8">
            <img src="sections/banner/9.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>

        <!-- èƒŒæ™¯åˆ‡æ¢å¡ç‰‡ 10 -->
        <div class="video-card-wrapper">
          <div class="video-card" data-bg-index="9">
            <img src="sections/banner/10.png" alt="AI SCROLL Background">
          </div>
          <div class="card-title">AI SCROLL</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- JavaScript äº¤äº’é€»è¾‘ -->
<script>
(function() {
  'use strict';

  const backgrounds = [
    'sections/banner/1.png',
    'sections/banner/2.jpg',
    'sections/banner/3.png',
    'sections/banner/4.png',
    'sections/banner/5.png',
    'sections/banner/6.png',
    'sections/banner/7.png',
    'sections/banner/8.png',
    'sections/banner/9.png',
    'sections/banner/10.png'
  ];

  const DESKTOP_BREAKPOINT = 992;
  const VISIBLE_COUNT = 5;
  const CENTER_OFFSET = Math.floor(VISIBLE_COUNT / 2); // 2
  const CLONE_COUNT = CENTER_OFFSET; // 2 ä¸ªå¡ç‰‡ç¼“å­˜åŒº
  const TRANSITION_MS = 500;
  const TRANSITION_EASING = 'cubic-bezier(0.4, 0, 0.2, 1)';

  const banner = document.querySelector('.banner');
  const cardsContainer = document.querySelector('.video-cards-container');
  const grid = document.querySelector('.video-cards-grid');
  if (!grid) {
    initSearchBox();
    return;
  }

  const originalWrappers = Array.from(grid.querySelectorAll('.video-card-wrapper'));
  if (!originalWrappers.length) {
    initSearchBox();
    return;
  }

  const templates = originalWrappers.map((wrapper, index) => {
    const clone = wrapper.cloneNode(true);
    clone.dataset.cardIndex = index;
    const card = clone.querySelector('.video-card');
    if (card) {
      card.dataset.cardIndex = index;
      card.classList.remove('active', 'adjacent'); // æ¸…ç†æ‰€æœ‰çŠ¶æ€ç±»å
    }
    return clone;
  });
  const totalCards = templates.length;
  let stepSize = 0;

  let activeIndex = (() => {
    const activeCard = grid.querySelector('.video-card.active');
    if (activeCard) {
      const idx = parseInt(activeCard.getAttribute('data-bg-index'), 10);
      if (!Number.isNaN(idx)) return idx % totalCards;
    }
    return CENTER_OFFSET;
  })();

  let currentMode = null;
  let isAnimating = false;
  let isScrollHijacked = false;
  let scrollHijackTimeout = null;
  let backgroundUpdateTimeout = null; // èƒŒæ™¯æ›´æ–°å»¶è¿Ÿå®šæ—¶å™¨
  const SCROLL_HIJACK_TIMEOUT = 500;
  const BACKGROUND_UPDATE_DELAY = 300; // æ»šåŠ¨åœæ­¢åå»¶è¿Ÿæ›´æ–°èƒŒæ™¯(æ¯«ç§’)
  const wheelBlockerOptions = { passive: false, capture: true };

  function applyPositionClass(card, positionIndex) {
    const clamped = Math.max(0, Math.min(VISIBLE_COUNT - 1, positionIndex));
    card.classList.add(`position-${clamped}`);
  }

  function preventPageScroll(event) {
    if (!isScrollHijacked) return;
    event.preventDefault();
  }

  function activateScrollHijack() {
    if (isScrollHijacked) return;
    isScrollHijacked = true;
    window.addEventListener('wheel', preventPageScroll, wheelBlockerOptions);
  }

  function releaseScrollHijack() {
    if (!isScrollHijacked) return;
    window.removeEventListener('wheel', preventPageScroll, wheelBlockerOptions);
    isScrollHijacked = false;
  }

  function scheduleScrollHijackRelease() {
    clearTimeout(scrollHijackTimeout);
    scrollHijackTimeout = setTimeout(() => {
      if (!isAnimating) {
        releaseScrollHijack();
      }
    }, SCROLL_HIJACK_TIMEOUT);
  }

  function applyBackgroundByIndex(index, immediate = false) {
    if (!banner) return;

    // æ¸…é™¤ä¹‹å‰çš„å»¶è¿Ÿå®šæ—¶å™¨
    if (backgroundUpdateTimeout) {
      clearTimeout(backgroundUpdateTimeout);
      backgroundUpdateTimeout = null;
    }

    // å®é™…åº”ç”¨èƒŒæ™¯çš„å‡½æ•°
    const doApplyBackground = () => {
      // ç›´æ¥ä»å½“å‰æ¿€æ´»çš„å¡ç‰‡ä¸­è·å–å›¾ç‰‡è·¯å¾„
      const activeCard = grid.querySelector('.video-card.active img');
      if (activeCard && activeCard.src) {
        // ä»å®Œæ•´ URL ä¸­æå–ç›¸å¯¹è·¯å¾„éƒ¨åˆ†
        const imgSrc = activeCard.src;
        banner.style.backgroundImage = `url('${imgSrc}')`;
      } else {
        // Fallback: ä½¿ç”¨ç´¢å¼•(å…¼å®¹æ—§é€»è¾‘)
        const bg = backgrounds[index % backgrounds.length];
        if (bg) {
          banner.style.backgroundImage = `url('${bg}')`;
        }
      }
    };

    // å¦‚æœæ˜¯ç«‹å³åº”ç”¨(ç‚¹å‡»ã€åˆå§‹åŒ–ç­‰),ç›´æ¥æ‰§è¡Œ
    if (immediate) {
      doApplyBackground();
    } else {
      // å¦åˆ™å»¶è¿Ÿåº”ç”¨(æ»šåŠ¨æ—¶)
      backgroundUpdateTimeout = setTimeout(doApplyBackground, BACKGROUND_UPDATE_DELAY);
    }
  }

  function measureStepSize() {
    const sample = grid.querySelector('.video-card-wrapper');
    if (!sample) return;
    const gap = parseFloat(window.getComputedStyle(grid).gap) || 0;
    stepSize = sample.getBoundingClientRect().width + gap;
  }

  function buildCarouselGrid() {
    grid.innerHTML = '';
    const newCards = [];

    for (let offset = -CLONE_COUNT; offset < totalCards + CLONE_COUNT; offset++) {
      const idx = (activeIndex + offset + totalCards) % totalCards;
      const node = templates[idx].cloneNode(true);
      node.dataset.cardIndex = idx;
      const card = node.querySelector('.video-card');
      if (card) {
        card.dataset.cardIndex = idx;

        // âœ¨ ç«‹å³è®¡ç®—å¹¶åº”ç”¨æœ€ç»ˆçŠ¶æ€ï¼Œé¿å…é—ªçƒ
        card.classList.remove('active', 'adjacent', 'position-0', 'position-1', 'position-2', 'position-3', 'position-4');
        node.classList.remove('gap-small', 'gap-medium', 'gap-large');

        // è®¡ç®—å½“å‰èŠ‚ç‚¹åœ¨å¯è§åŒºåŸŸçš„ä½ç½®
        const visibleStart = CLONE_COUNT;
        const visibleEnd = CLONE_COUNT + VISIBLE_COUNT - 1;
        const centerPos = visibleStart + CENTER_OFFSET;
        const position = CLONE_COUNT + offset;
        const visiblePosition = position - visibleStart;

        // åº”ç”¨å¡ç‰‡çŠ¶æ€ç±»
        if (position === centerPos) {
          card.classList.add('active');
        } else if (position === centerPos - 1 || position === centerPos + 1) {
          card.classList.add('adjacent');
        }

        // å…ˆæ ¹æ®ç›®æ ‡ä½ç½®åº”ç”¨å€¾æ–œä½ç½®ç±»,éšè—å¡ç‰‡åŒæ ·ä¿æŒå¯¹é½
        applyPositionClass(card, visiblePosition);

        // åº”ç”¨é—´è·ç±»ï¼ˆä»…é™å¯è§åŒºåŸŸï¼‰
        if (position >= visibleStart && position <= visibleEnd) {
          if (visiblePosition === 0 || visiblePosition === VISIBLE_COUNT - 1) {
            node.classList.add('gap-small');
          } else if (visiblePosition === 1 || visiblePosition === VISIBLE_COUNT - 2) {
            node.classList.add('gap-medium');
          } else if (visiblePosition === CENTER_OFFSET) {
            node.classList.add('gap-large');
          }
        }

        card.style.transition = 'none'; // ç¦ç”¨ transition
        newCards.push(card);
      }
      grid.appendChild(node);
    }

    measureStepSize();
    // updateCarouselClasses(); // å·²åœ¨ä¸Šé¢åº”ç”¨ï¼Œæ­¤å¤„å¯çœç•¥
    resetCarouselTransform(); // å†é‡ç½® transform

    // å¼ºåˆ¶ reflow åé‡æ–°å¯ç”¨ transition
    grid.offsetHeight;
    requestAnimationFrame(() => {
      newCards.forEach(card => {
        card.style.transition = ''; // æ¢å¤ CSS å®šä¹‰çš„ transition
      });
    });

    // æ›´æ–°èƒŒæ™¯(å»¶è¿Ÿåº”ç”¨,æ»šåŠ¨åœæ­¢åæ‰åˆ‡æ¢)
    applyBackgroundByIndex(activeIndex, false);
  }

  function resetCarouselTransform() {
    const base = -(CLONE_COUNT * stepSize);
    grid.style.transition = 'none';
    grid.style.transform = `translateX(${base}px)`;
    grid.offsetHeight; // force reflow
    grid.style.transition = `transform ${TRANSITION_MS}ms ${TRANSITION_EASING}`;
  }

  function updateCarouselClasses() {
    const wrappers = Array.from(grid.children);
    wrappers.forEach((wrapper, idx) => {
      const card = wrapper.querySelector('.video-card');
      if (!card) return;
      card.classList.remove('active', 'adjacent');
      wrapper.classList.remove('gap-small', 'gap-medium', 'gap-large');

      const visibleStart = CLONE_COUNT;
      const visibleEnd = CLONE_COUNT + VISIBLE_COUNT - 1;
      const centerPos = visibleStart + CENTER_OFFSET;

      if (idx >= visibleStart && idx <= visibleEnd) {
        // è®¾ç½®å¡ç‰‡æ¿€æ´»çŠ¶æ€
        if (idx === centerPos) {
          card.classList.add('active');
        } else if (idx === centerPos - 1 || idx === centerPos + 1) {
          card.classList.add('adjacent');
        }

        const visiblePosition = idx - visibleStart;
        if (visiblePosition === 0 || visiblePosition === VISIBLE_COUNT - 1) {
          wrapper.classList.add('gap-small');
        } else if (visiblePosition === 1 || visiblePosition === VISIBLE_COUNT - 2) {
          wrapper.classList.add('gap-medium');
        } else if (visiblePosition === CENTER_OFFSET) {
          wrapper.classList.add('gap-large');
        }
      }
    });
    // æ³¨æ„: updateCarouselClasses å½“å‰æœªè¢«ä½¿ç”¨,å¦‚éœ€è°ƒç”¨åº”æ ¹æ®åœºæ™¯å†³å®š immediate å‚æ•°
    // applyBackgroundByIndex(activeIndex);
  }

  function previewClassesForDirection(direction) {
    const wrappers = Array.from(grid.children);
    const centerPos = CLONE_COUNT + CENTER_OFFSET;
    const nextCenter = centerPos + (direction === 'left' ? 1 : -1);

    wrappers.forEach((wrapper, idx) => {
      const card = wrapper.querySelector('.video-card');
      if (!card) return;

      // ä¿®æ”¹å¡ç‰‡çŠ¶æ€ç±»
      card.classList.remove('active', 'adjacent', 'position-0', 'position-1', 'position-2', 'position-3', 'position-4');
      if (idx === nextCenter) {
        card.classList.add('active');
      } else if (idx === nextCenter - 1 || idx === nextCenter + 1) {
        card.classList.add('adjacent');
      }

      // âœ¨ æå‰è®¡ç®—å¹¶åº”ç”¨ç›®æ ‡ä½ç½®çš„é—´è·ç±»å’Œå€¾æ–œç±»ï¼Œå®ç°æ–œå‘å¹³æ»‘è¿‡æ¸¡
      wrapper.classList.remove('gap-small', 'gap-medium', 'gap-large');

      // è®¡ç®—å¡ç‰‡åœ¨åŠ¨ç”»åçš„å¯è§ä½ç½®
      const currentVisiblePos = idx - CLONE_COUNT;
      const targetVisiblePos = direction === 'left'
        ? currentVisiblePos - 1  // å·¦æ»‘æ—¶ï¼Œæ¯ä¸ªå¡ç‰‡å‘å·¦ç§»åŠ¨ä¸€ä¸ªä½ç½®
        : currentVisiblePos + 1; // å³æ»‘æ—¶ï¼Œæ¯ä¸ªå¡ç‰‡å‘å³ç§»åŠ¨ä¸€ä¸ªä½ç½®

      // éšè—å¡ç‰‡åŒæ ·æå‰åº”ç”¨å€¾æ–œä½ç½®ç±»,ä¿æŒè§†è§‰å¯¹é½
      applyPositionClass(card, targetVisiblePos);

      // æ ¹æ®ç›®æ ‡ä½ç½®åº”ç”¨å¯¹åº”çš„é—´è·ç±»ï¼ˆä»…é™å¯è§åŒºåŸŸï¼‰
      if (targetVisiblePos >= 0 && targetVisiblePos < VISIBLE_COUNT) {
        if (targetVisiblePos === 0 || targetVisiblePos === VISIBLE_COUNT - 1) {
          wrapper.classList.add('gap-small');
        } else if (targetVisiblePos === 1 || targetVisiblePos === VISIBLE_COUNT - 2) {
          wrapper.classList.add('gap-medium');
        } else if (targetVisiblePos === CENTER_OFFSET) {
          wrapper.classList.add('gap-large');
        }
      }
    });
  }

  function animateSlide(direction) {
    return new Promise((resolve) => {
      if (!stepSize) {
        resolve();
        return;
      }
      const base = -(CLONE_COUNT * stepSize);
      const target = direction === 'left'
        ? base - stepSize
        : base + stepSize;

      previewClassesForDirection(direction);

      const handleEnd = (event) => {
        if (event.target !== grid) return;
        grid.removeEventListener('transitionend', handleEnd);
        resolve();
      };

      grid.addEventListener('transitionend', handleEnd);
      requestAnimationFrame(() => {
        grid.style.transform = `translateX(${target}px)`;
      });
    });
  }

  // å¤šæ­¥æ»‘åŠ¨åŠ¨ç”»ï¼ˆä¸€æ¬¡æ€§åˆ°è¾¾ç›®æ ‡ï¼Œä¸æ˜¾ç¤ºä¸­é—´çŠ¶æ€ï¼‰
  function animateMultiStepSlide(direction, steps) {
    return new Promise((resolve) => {
      if (!stepSize || steps === 0) {
        resolve();
        return;
      }

      const base = -(CLONE_COUNT * stepSize);
      const offset = stepSize * steps;
      const target = direction === 'left' ? base - offset : base + offset;

      // æå‰é¢„è§ˆæœ€ç»ˆçŠ¶æ€çš„ç±»å
      previewMultiStepClasses(direction, steps);

      const handleEnd = (event) => {
        if (event.target !== grid) return;
        grid.removeEventListener('transitionend', handleEnd);
        resolve();
      };

      grid.addEventListener('transitionend', handleEnd);
      requestAnimationFrame(() => {
        grid.style.transform = `translateX(${target}px)`;
      });
    });
  }

  // é¢„è§ˆå¤šæ­¥è·³è½¬åçš„æœ€ç»ˆçŠ¶æ€ç±»å
  function previewMultiStepClasses(direction, steps) {
    const wrappers = Array.from(grid.children);
    const centerPos = CLONE_COUNT + CENTER_OFFSET;
    const offset = direction === 'left' ? steps : -steps;
    const nextCenter = centerPos + offset;

    wrappers.forEach((wrapper, idx) => {
      const card = wrapper.querySelector('.video-card');
      if (!card) return;

      // ä¿®æ”¹å¡ç‰‡çŠ¶æ€ç±»
      card.classList.remove('active', 'adjacent', 'position-0', 'position-1', 'position-2', 'position-3', 'position-4');
      if (idx === nextCenter) {
        card.classList.add('active');
      } else if (idx === nextCenter - 1 || idx === nextCenter + 1) {
        card.classList.add('adjacent');
      }

      // æå‰åº”ç”¨ç›®æ ‡ä½ç½®çš„é—´è·ç±»å’Œå€¾æ–œä½ç½®ç±»
      wrapper.classList.remove('gap-small', 'gap-medium', 'gap-large');

      const currentVisiblePos = idx - CLONE_COUNT;
      const targetVisiblePos = currentVisiblePos - offset;

      // éšè—å¡ç‰‡åŒæ ·åº”ç”¨å€¾æ–œä½ç½®ç±»
      applyPositionClass(card, targetVisiblePos);

      if (targetVisiblePos >= 0 && targetVisiblePos < VISIBLE_COUNT) {
        if (targetVisiblePos === 0 || targetVisiblePos === VISIBLE_COUNT - 1) {
          wrapper.classList.add('gap-small');
        } else if (targetVisiblePos === 1 || targetVisiblePos === VISIBLE_COUNT - 2) {
          wrapper.classList.add('gap-medium');
        } else if (targetVisiblePos === CENTER_OFFSET) {
          wrapper.classList.add('gap-large');
        }
      }
    });
  }

  async function slide(direction, steps) {
    if (isAnimating || steps === 0) return;
    isAnimating = true;

    // è®¡ç®—æœ€ç»ˆç›®æ ‡ç´¢å¼•
    const indexChange = direction === 'left' ? steps : -steps;
    const targetIndex = (activeIndex + indexChange + totalCards) % totalCards;

    // ä¸€æ¬¡æ€§åŠ¨ç”»åˆ°ç›®æ ‡ä½ç½®ï¼ˆä¸æ˜¾ç¤ºä¸­é—´çŠ¶æ€ï¼‰
    await animateMultiStepSlide(direction, steps);

    // æ›´æ–°ç´¢å¼•å¹¶é‡å»ºDOMï¼ˆä»…ä¸€æ¬¡ï¼‰
    activeIndex = targetIndex;
    buildCarouselGrid();

    isAnimating = false;
  }

  function handleCarouselClick(event) {
    const card = event.target.closest('.video-card');
    if (!card || isAnimating) return;
    const wrapper = card.closest('.video-card-wrapper');
    const wrappers = Array.from(grid.children);
    const targetPos = wrappers.indexOf(wrapper);
    const centerPos = CLONE_COUNT + CENTER_OFFSET;
    if (targetPos === -1 || targetPos === centerPos) {
      applyBackgroundByIndex(activeIndex, true); // ç‚¹å‡»å·²é€‰ä¸­å¡ç‰‡,ç«‹å³åº”ç”¨èƒŒæ™¯
      return;
    }
    const direction = targetPos > centerPos ? 'left' : 'right';
    const steps = Math.abs(targetPos - centerPos);
    slide(direction, steps);
  }


  // æ»šè½®äº‹ä»¶å¤„ç†ï¼šæ— è®ºçºµå‘/æ¨ªå‘ï¼Œç»Ÿä¸€åŠ«æŒå¹¶è½¬ä¸ºæ¨ªå‘åˆ‡æ¢
  function handleCarouselWheel(event) {
    if (isAnimating) {
      event.preventDefault();
      event.stopPropagation();
      activateScrollHijack();
      scheduleScrollHijackRelease();
      return;
    }
    event.preventDefault();
    event.stopPropagation();

    activateScrollHijack();

    const absDeltaX = Math.abs(event.deltaX);
    const absDeltaY = Math.abs(event.deltaY);
    const primaryDelta = absDeltaX > absDeltaY ? event.deltaX : event.deltaY;

    if (Math.abs(primaryDelta) < 1) {
      scheduleScrollHijackRelease();
      return;
    }

    // ğŸ¯ æŒç»­æ»šåŠ¨ç­–ç•¥: æ¯æ¬¡æ»šè½®äº‹ä»¶éƒ½åˆ‡æ¢ä¸€ä¸ªå¡ç‰‡,ä¸ç®¡æ»šåŠ¨é‡å¤§å°
    // åªè¦æŒç»­æ»šåŠ¨,å°±æŒç»­åˆ‡æ¢
    const direction = primaryDelta > 0 ? 'left' : 'right';
    slide(direction, 1).finally(scheduleScrollHijackRelease);
  }

  function buildStaticGrid() {
    grid.innerHTML = '';
    templates.forEach((template) => {
      const node = template.cloneNode(true);
      node.dataset.cardIndex = template.dataset.cardIndex;
      const card = node.querySelector('.video-card');
      if (card) card.dataset.cardIndex = template.dataset.cardIndex;
      grid.appendChild(node);
    });
    updateStaticClasses();
  }

  function updateStaticClasses() {
    const wrappers = Array.from(grid.children);
    wrappers.forEach((wrapper, idx) => {
      const card = wrapper.querySelector('.video-card');
      if (!card) return;
      card.classList.remove('active', 'adjacent');
      wrapper.classList.remove('gap-small', 'gap-medium', 'gap-large');
      const distance = Math.abs(idx - activeIndex);
      if (distance === 0) {
        card.classList.add('active');
        wrapper.classList.add('gap-large');
      } else if (distance === 1) {
        card.classList.add('adjacent');
        wrapper.classList.add('gap-medium');
      } else if (distance === 2) {
        wrapper.classList.add('gap-small');
      }
    });
    applyBackgroundByIndex(activeIndex, true); // ç§»åŠ¨ç«¯ç‚¹å‡»,ç«‹å³åº”ç”¨èƒŒæ™¯
  }

  function handleStaticClick(event) {
    const card = event.target.closest('.video-card');
    if (!card) return;
    const wrapper = card.closest('.video-card-wrapper');
    const index = parseInt(wrapper.dataset.cardIndex, 10);
    if (Number.isNaN(index)) return;
    activeIndex = index;
    updateStaticClasses();
    if (cardsContainer) {
      wrapper.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
    }
  }

  function initCarouselMode() {
    grid.removeEventListener('click', handleStaticClick);
    grid.addEventListener('click', handleCarouselClick);

    // æ·»åŠ æ»šè½®ç›‘å¬ï¼ˆæ”¯æŒæ¨ªå‘æ»šåŠ¨åˆ‡æ¢å¡ç‰‡ï¼‰
    if (cardsContainer) {
      cardsContainer.addEventListener('wheel', handleCarouselWheel, { passive: false });
    }

    buildCarouselGrid();
  }

  function initStaticMode() {
    grid.removeEventListener('click', handleCarouselClick);

    // ç§»é™¤æ»šè½®ç›‘å¬
    if (cardsContainer) {
      cardsContainer.removeEventListener('wheel', handleCarouselWheel);
    }

    grid.addEventListener('click', handleStaticClick);
    buildStaticGrid();
    releaseScrollHijack();
  }

  function handleResize() {
    const nextMode = window.innerWidth >= DESKTOP_BREAKPOINT ? 'carousel' : 'static';
    if (nextMode === currentMode) return;
    currentMode = nextMode;
    if (currentMode === 'carousel') {
      initCarouselMode();
    } else {
      initStaticMode();
    }
  }

  function initSearchBox() {
    const searchInput = document.querySelector('.search-input');
    const runEngineBtn = document.querySelector('.btn-run-engine');

    if (searchInput && runEngineBtn) {
      runEngineBtn.addEventListener('click', () => {
        const query = searchInput.value.trim();
        if (!query) {
          searchInput.focus();
          return;
        }
        console.log('Search query:', query);
      });

      searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          runEngineBtn.click();
        }
      });
    }
  }

  function init() {
    currentMode = window.innerWidth >= DESKTOP_BREAKPOINT ? 'carousel' : 'static';
    if (currentMode === 'carousel') {
      initCarouselMode();
    } else {
      initStaticMode();
    }
    window.addEventListener('resize', handleResize);
    initSearchBox();
  }

  init();
})();
</script>
