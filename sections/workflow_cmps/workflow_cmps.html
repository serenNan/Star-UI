<!-- ===== WORKFLOW_CMPS SECTION ===== -->
<!-- ===== WORKFLOW_CMPS 模块 ===== -->
<style>
  /* Workflow CMPS Section Styles */
  .workflow-cmps {
    padding: var(--spacing-3xl) 0;
    background: var(--color-bg);
  }

  .workflow-cmps-container {
    max-width: var(--container-width);
    margin: 0 auto;
    padding: 0 var(--spacing-lg);
  }

  /* 标题区域 */
  .workflow-cmps-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .workflow-cmps-label {
    font-family: 'Sora', sans-serif;
    font-size: 1.2rem;
    font-weight: 300;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-sm);
  }

  .workflow-cmps-title {
    font-family: 'Sora', sans-serif;
    font-size: clamp(2rem, 4vw, 2.8rem);
    font-weight: 700;
    line-height: 1.2;
    color: var(--color-text);
    margin-bottom: var(--spacing-lg);
  }

  .workflow-cmps-description {
    font-family: 'Sora', sans-serif;
    font-size: clamp(1rem, 1.5vw, 1.25rem);
    font-weight: 300;
    line-height: 1.6;
    color: var(--color-text-secondary);
    max-width: 800px;
    margin: 0 auto;
  }

  /* 主要内容区 - 左侧卡片,右侧可视化区域,响应式 */
  .workflow-cmps-content {
    display: grid;
    grid-template-columns: 1fr 2.2fr;
    gap: var(--spacing-2xl);
    align-items: stretch;
    max-width: 1800px;
    margin: 0 auto;
  }

  /* 卡片容器 */
  .workflow-cmps-cards {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
  }

  /* 单个卡片 - 圆角背景,阴影效果,悬浮动画 */
  .workflow-cmps-card {
    background: var(--color-bg-secondary);
    border-radius: 16px;
    overflow: hidden;
    position: relative;
    min-height: 180px;
    width: 100%;
    transition: transform var(--transition), box-shadow var(--transition);
    cursor: pointer;
  }

  .workflow-cmps-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }

  /* 卡片图片容器 - 绝对定位背景 */
  .workflow-cmps-card-image-wrapper {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    overflow: hidden;
    background: #2a2a2a;
  }

  .workflow-cmps-card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .workflow-cmps-card-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    cursor: pointer;
  }

  /* 卡片遮罩层 - 底部渐变黑色,保护文字可读性 */
  .workflow-cmps-card-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 60%;
    background: linear-gradient(to top,
        rgba(0, 0, 0, 0.98) 0%,
        rgba(0, 0, 0, 0.96) 20%,
        rgba(0, 0, 0, 0.9) 40%,
        rgba(0, 0, 0, 0.7) 60%,
        rgba(0, 0, 0, 0.4) 80%,
        rgba(0, 0, 0, 0.15) 95%,
        transparent 100%);
    z-index: 1;
    pointer-events: none;
  }

  /* 卡片文字层 - 绝对定位在顶部,通过padding控制边距和间距 */
  .workflow-cmps-card-content {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    padding: var(--spacing-sm) var(--spacing-sm);
    z-index: 2;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  /* 卡片顶部标题 - 序号和标题横排 */
  .workflow-cmps-card-header {
    display: flex;
    align-items: baseline;
    gap: var(--spacing-sm);
  }

  .workflow-cmps-card-number {
    font-family: 'Sora', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text);
    line-height: 1;
  }

  .workflow-cmps-card-title {
    font-family: 'Sora', sans-serif;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--color-text);
    line-height: 1;
  }

<<<<<<< HEAD
  /* 卡片描述 - 在卡片下部，灰色细体 */
=======
  /* 卡片描述 - 底部对齐,淡色文字 */
>>>>>>> origin/serenNan
.workflow-cmps-card-description {
    font-family: 'Sora', sans-serif;
    font-size: 0.875rem;
    font-weight: 300;
    line-height: 1.5;
    color: var(--color-text-secondary);
    margin: 0;
    margin-top: auto;
  }

  /* 右侧可视化区域 - 显示大图和底部提示词输入框 */
  .workflow-cmps-visual {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 20px;
    overflow: hidden;
    background: #2a2a2a;
  }

  .workflow-cmps-prompt {
    position: absolute;
    left: 50%;
    bottom: 1.5rem;
    transform: translateX(-50%);
    width: min(93%, 840px);
    padding: 0;
    z-index: 5;
  }

  .workflow-cmps-prompt-box {
    position: relative;
  }

  .workflow-cmps-prompt-input {
    width: 100%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.45);
    color: white;
    font-size: 0.78rem;
    line-height: 1.4;
    padding: 0.85rem 220px 0.85rem 1.1rem;
    resize: none;
    overflow: hidden;
    min-height: 56px;
    max-height: 56px;
    outline: none;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.25);
  }

  .workflow-cmps-prompt-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }

  .workflow-cmps-prompt-btn {
    position: absolute;
    top: 45%;
    right: 8px;
    transform: translateY(-50%);
    border: none;
    border-radius: 8px;
    background: white;
    color: black;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 0.6rem 1.6rem;
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    cursor: pointer;
    transition: transform 0.2s ease, background 0.2s ease;
  }

  .workflow-cmps-prompt-btn svg {
    width: 1rem;
    height: 0.8rem;
    fill: currentColor;
  }

  .workflow-cmps-prompt-btn:hover {
    transform: translateY(-50%) scale(1.02);
    background: rgba(255, 255, 255, 0.92);
  }

  .workflow-cmps-visual-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    border-radius: 20px;
  }

  .workflow-cmps-visual-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    border-radius: 20px;
    cursor: pointer;
  }

  /* 视频弹窗容器 */
  .video-modal {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
  }

  /* 激活状态的卡片 */
  .workflow-cmps-card.active {
    border: 1px solid rgba(255, 255, 255, 0.511);
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
  }

  .workflow-cmps-card.active .workflow-cmps-card-video {
    opacity: 1;
  }

  .video-modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-width: 90%;
    max-height: 90%;
    width: auto;
    height: auto;
  }

  .video-modal video {
    width: 100%;
    height: 100%;
    max-width: 80vw;
    max-height: 80vh;
    object-fit: contain;
  }

  .video-modal-close {
    position: absolute;
    top: 20px;
    right: 40px;
    color: white;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10001;
    transition: color 0.3s ease;
  }

  .video-modal-close:hover {
    color: #ccc;
  }

  /* 响应式布局 */
  @media (max-width: 991px) {
    .workflow-cmps {
      padding: var(--spacing-2xl) 0;
    }

    .workflow-cmps-header {
      margin-bottom: var(--spacing-2xl);
    }

    .workflow-cmps-content {
      grid-template-columns: 1fr;
      gap: var(--spacing-xl);
      align-items: start;
    }

    .workflow-cmps-visual {
      height: 600px;
      min-height: 600px;
      order: -1;
    }

    .workflow-cmps-card {
      min-height: 150px;
    }
  }

  @media (max-width: 767px) {
    .workflow-cmps-container {
      padding: 0 var(--spacing-md);
    }

    .workflow-cmps-header {
      margin-bottom: var(--spacing-xl);
    }

    .workflow-cmps-title {
      font-size: clamp(1.5rem, 5vw, 2rem);
    }

    .workflow-cmps-description {
      font-size: 0.9rem;
    }

    .workflow-cmps-content {
      gap: var(--spacing-lg);
      align-items: start;
    }

    .workflow-cmps-visual {
      height: 500px;
      min-height: 500px;
      border-radius: 16px;
    }

    .workflow-cmps-visual-image {
      border-radius: 16px;
    }

    .workflow-cmps-card {
      min-height: 120px;
    }

    .workflow-cmps-card-number {
      font-size: 1.5rem;
    }

    .workflow-cmps-card-title {
      font-size: 1.2rem;
    }

    .workflow-cmps-card-description {
      font-size: 0.75rem;
    }
  }
</style>

<!-- HTML 结构 -->
<section class="workflow-cmps" id="workflow-cmps">
  <div class="workflow-cmps-container">
    <!-- 标题区域 -->
    <div class="workflow-cmps-header">
      <p class="workflow-cmps-label">TRECLIPSE PRODUCTION</p>
      <h2 class="workflow-cmps-title">From the Treclipse Studio</h2>
      <p class="workflow-cmps-description">
        Click to experience with sound.
      </p>
    </div>

    <!-- 主要内容区 - 左右布局 -->
    <div class="workflow-cmps-content">
      <!-- 左侧卡片列表 -->
      <div class="workflow-cmps-cards">
        <!-- 卡片 1: Noir Cinematic -->
        <div class="workflow-cmps-card">
          <div class="workflow-cmps-card-image-wrapper">
            <video class="workflow-cmps-card-video" muted loop playsinline data-video-src="assets/workflow_cmps/videos/workflow_cmps-video-01.mp4">
<<<<<<< HEAD
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-02.mp4" type="video/mp4">
=======
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-10.mp4" type="video/mp4">
>>>>>>> origin/serenNan
            </video>
            <div class="workflow-cmps-card-overlay"></div>
          </div>
          <div class="workflow-cmps-card-content">
            <div class="workflow-cmps-card-header">
              <span class="workflow-cmps-card-number"></span>
              <h3 class="workflow-cmps-card-title">Noir Cinematic</h3>
            </div>
            <p class="workflow-cmps-card-description">
              Moody shadows, dramatic lighting, and tension-filled, atmospheric storytelling.
            </p>
          </div>
        </div>

        <!-- 卡片 2: Art-House Minimalism -->
        <div class="workflow-cmps-card">
          <div class="workflow-cmps-card-image-wrapper">
            <video class="workflow-cmps-card-video" muted loop playsinline data-video-src="assets/workflow_cmps/videos/workflow_cmps-video-03.mp4">
<<<<<<< HEAD
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-04.mp4" type="video/mp4">
=======
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-14.mp4" type="video/mp4">
>>>>>>> origin/serenNan
            </video>
            <div class="workflow-cmps-card-overlay"></div>
          </div>
          <div class="workflow-cmps-card-content">
            <div class="workflow-cmps-card-header">
              <span class="workflow-cmps-card-number"></span>
              <h3 class="workflow-cmps-card-title">Art-House Minimalism</h3>
            </div>
            <p class="workflow-cmps-card-description">
              Quiet compositions, subtle emotion, and refined, understated visual poetry.
            </p>
          </div>
        </div>

        <!-- 卡片 3: Campaigns -->
        <div class="workflow-cmps-card">
          <div class="workflow-cmps-card-image-wrapper">
            <video class="workflow-cmps-card-video" muted loop playsinline data-video-src="assets/workflow_cmps/videos/workflow_cmps-video-05.mp4">
<<<<<<< HEAD
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-06.mp4" type="video/mp4">
=======
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-00.mp4" type="video/mp4">
>>>>>>> origin/serenNan
            </video>
            <div class="workflow-cmps-card-overlay"></div>
          </div>
          <div class="workflow-cmps-card-content">
            <div class="workflow-cmps-card-header">
              <span class="workflow-cmps-card-number"></span>
              <h3 class="workflow-cmps-card-title">Campaigns</h3>
            </div>
            <p class="workflow-cmps-card-description">
              Produce cinematic ads and campaign films with studio-grade quality.
            </p>
          </div>
        </div>

        <!-- 卡片 4: Stylized Cinematics -->
        <div class="workflow-cmps-card">
          <div class="workflow-cmps-card-image-wrapper">
<<<<<<< HEAD
            <img src="assets/workflow_cmps/images/workflow_cmps-image-01.jpg" alt="Storyboard" class="workflow-cmps-card-image" loading="lazy">
=======
            <video class="workflow-cmps-card-video" muted loop playsinline data-video-src="assets/workflow_cmps/videos/workflow_cmps-video-07.mp4">
              <source src="assets/workflow_cmps/videos/workflow_cmps-video-16.mp4" type="video/mp4">
            </video>
>>>>>>> origin/serenNan
            <div class="workflow-cmps-card-overlay"></div>
          </div>
          <div class="workflow-cmps-card-content">
            <div class="workflow-cmps-card-header">
              <span class="workflow-cmps-card-number"></span>
              <h3 class="workflow-cmps-card-title">Stylized Cinematics</h3>
            </div>
            <p class="workflow-cmps-card-description">
              Comic, stop-motion, collage, and mixed-media aesthetics for expressive storytelling.
            </p>
          </div>
        </div>
      </div>

      <!-- 右侧可视化区域 -->
      <div class="workflow-cmps-visual">
        <video class="workflow-cmps-visual-video" muted loop playsinline data-video-src="assets/workflow_cmps/videos/workflow_cmps-video-07.mp4">
          <source src="assets/workflow_cmps/videos/workflow_cmps-video-08.mp4" type="video/mp4">
        </video>
        <div class="workflow-cmps-prompt" role="region" aria-live="polite">
          <div class="workflow-cmps-prompt-box">
            <textarea class="workflow-cmps-prompt-input" rows="2" placeholder="A cinematic noir cityscape drenched in rain and reflective neon." spellcheck="false"></textarea>
            <button class="workflow-cmps-prompt-btn" type="button">
              <span>Generate Similar</span>
              <svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M20 14c1.2 0 2 0.8 2 2s-0.8 2-2 2-2-0.8-2-2 0.8-2 2-2zm12-8c2 0 4 2 4 4s-2 4-4 4-4-2-4-4 2-4 4-4zm12 4c3 0 6 3 6 6s-3 6-6 6-6-3-6-6 3-6 6-6zm-12 12c1.5 0 3 1.5 3 3s-1.5 3-3 3-3-1.5-3-3 1.5-3 3-3z" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- 视频弹窗模态框 -->
<div id="workflowcmps-video-modal" class="video-modal">
  <span class="video-modal-close">&times;</span>
  <div class="video-modal-content">
    <video id="workflowcmps-modal-video" controls>
      <source src="" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
</div>

<script>
  // Workflow CMPS 模块初始化 - 处理卡片点击、视频切换和弹窗功能
  (function () {
    'use strict';

    const initWorkflowCmps = () => {
      // 获取所有需要的DOM元素
      const cards = document.querySelectorAll('.workflow-cmps-card');
      const mainVideo = document.querySelector('.workflow-cmps-visual-video');
<<<<<<< HEAD
=======
      const promptInput = document.querySelector('.workflow-cmps-prompt-input');
      const promptButton = document.querySelector('.workflow-cmps-prompt-btn');
      const promptContainer = document.querySelector('.workflow-cmps-prompt');
      const WORKFLOW_PROMPTS = [
        'A Nike-style motivational saga following an African-American boxer who rises from childhood defeat to become a world champion.',
        'A melancholic narrative following an aging man reflecting on his past through fragmented moments of reality and surreal memory.',
        'A luxurious furniture campaign showcasing craftsmanship and opulence through atmospheric, artfully composed scenes.',
        'An anime spy adventure featuring a secret agent and his companion in a James-Bond-inspired tale of romance and action.'
      ];

      const goWaitlist = () => {
        window.location.href = 'waitlist.html';
      };

      const applyWorkflowPrompt = (index = 0) => {
        if (!promptInput || !WORKFLOW_PROMPTS.length) return;
        const prompt = WORKFLOW_PROMPTS[index % WORKFLOW_PROMPTS.length];
        promptInput.value = prompt;
        promptInput.setAttribute('data-active-index', index.toString());
      };

      if (promptContainer) {
        promptContainer.addEventListener('click', (event) => {
          event.stopPropagation();
        });
      }

      if (promptInput) {
        promptInput.addEventListener('click', (event) => event.stopPropagation());
        promptInput.addEventListener('keypress', (event) => {
          if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            goWaitlist();
          }
        });
      }

      if (promptButton) {
        promptButton.addEventListener('click', (event) => {
          event.stopPropagation();
          goWaitlist();
        });
      }
>>>>>>> origin/serenNan

      if (!mainVideo) return;

      // 视频错误处理
      const videos = document.querySelectorAll('.workflow-cmps-card-video, .workflow-cmps-visual-video');
      videos.forEach((video) => {
        video.addEventListener('error', function () {
          console.warn(`Failed to load video: ${this.querySelector('source').src}`);
          this.style.display = 'none';
        });

        // 初始暂停视频
        video.pause();
      });

      // 为每个卡片添加点击和悬浮事件
      cards.forEach((card, index) => {
        const cardVideo = card.querySelector('.workflow-cmps-card-video');
        if (!cardVideo) return;

        // 点击卡片切换主视频
        card.addEventListener('click', function () {
          // 获取卡片视频源
          const videoSrc = cardVideo.querySelector('source').src;

<<<<<<< HEAD
          // 更新右侧主视频
=======
          // 切换主视频
>>>>>>> origin/serenNan
          mainVideo.src = videoSrc;
          mainVideo.play().catch(err => {
            console.warn('主视频播放失败:', err);
          });

          // 更新激活状态
          cards.forEach(c => c.classList.remove('active'));
          card.classList.add('active');
          applyWorkflowPrompt(index);
        });

        // 鼠标悬浮播放卡片视频(可选)
        card.addEventListener('mouseenter', () => {
          cardVideo.play().catch(err => {
            console.warn('卡片视频播放失败:', err);
          });
        });

        card.addEventListener('mouseleave', () => {
          cardVideo.pause();
          cardVideo.currentTime = 0;
        });

        // 设置卡片为可点击状态
        card.style.cursor = 'pointer';
      });

      // 默认激活第一个卡片
      if (cards.length > 0) {
        const firstCardVideo = cards[0].querySelector('.workflow-cmps-card-video');
        if (firstCardVideo) {
          mainVideo.src = firstCardVideo.querySelector('source').src;
          cards[0].classList.add('active');
        }
        applyWorkflowPrompt(0);
      } else {
        applyWorkflowPrompt(0);
      }

      // 点击主视频区域打开全屏弹窗
      const mainVideoWrapper = document.querySelector('.workflow-cmps-visual');
      if (mainVideoWrapper) {
        mainVideoWrapper.addEventListener('click', function () {
          if (mainVideo.src) {
            openVideoModal(mainVideo.src);
          }
        });
        mainVideo.style.cursor = 'pointer';
      }

      // 弹窗逻辑
      const modal = document.getElementById('workflowcmps-video-modal');
      const modalVideo = document.getElementById('workflowcmps-modal-video');
      const closeBtn = document.querySelector('#workflowcmps-video-modal .video-modal-close');

      function openVideoModal(videoSrc) {
        modalVideo.src = videoSrc;
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden'; // 禁止页面滚动
      }

      function closeVideoModal() {
        modal.style.display = 'none';
        modalVideo.pause();
        modalVideo.src = '';
        document.body.style.overflow = ''; // 恢复滚动
      }

      // 关闭按钮
      if (closeBtn) {
        closeBtn.addEventListener('click', closeVideoModal);
      }

      // 点击背景关闭
      if (modal) {
        modal.addEventListener('click', function (e) {
          if (e.target === modal) {
            closeVideoModal();
          }
        });
      }

      // ESC键关闭
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && modal.style.display === 'block') {
          closeVideoModal();
        }
      });
    };

    // DOM 加载完成后初始化
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initWorkflowCmps);
    } else {
      initWorkflowCmps();
    }
  })();
</script>
